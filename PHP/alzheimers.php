<?php
/*! \file alzheimers.php
 *  \brief Contains generic class for communication with a database in php
 *      This should be used to build upon for other projects

Modifications:
2013-10-06  NT  Created
----------------------------------------------------------------------------------*/

class ALZHEIMERS {
  //--------------------------------------------------------------------------------------------------------------------------------//
 //----- Constants ----------------------------------------------------------------------------------------------------------------//
//--------------------------------------------------------------------------------------------------------------------------------//
    const DEFAULT_TIMEOUT       = 30;
    
  //--------------------------------------------------------------------------------------------------------------------------------//
 //----- Public Variables ---------------------------------------------------------------------------------------------------------//
//--------------------------------------------------------------------------------------------------------------------------------//
    
  //--------------------------------------------------------------------------------------------------------------------------------//
 //----- Private Variables --------------------------------------------------------------------------------------------------------//
//--------------------------------------------------------------------------------------------------------------------------------//
    private $server;      ///< Default write connection
    private $defaultTimeout;
    
    private $lastErrorCode      = 0;
    private $lastErrorMsg       = '';
    private $lastQuery          = '';   ///< Keeps track of the last query if we had an error
    
  //--------------------------------------------------------------------------------------------------------------------------------//
 //----- Private Functions ---------------------------------------------------------------------------------------------------------//
//--------------------------------------------------------------------------------------------------------------------------------//

    function __construct($host = 'localhost', $port = 11211, $timeout = null) {
        
        $this->server = new Memcached();
        $this->server->addServer($host, $port);
        
        if ($timeout != null && is_numeric($timeout))
            $this->defaultTimeout = $timeout;
        else
            $this->defaultTimeout = ALZHEIMERS::DEFAULT_TIMEOUT;
    }
    
    function __destruct () {
        
    }
    

  //--------------------------------------------------------------------------------------------------------------------------------//
 //----- Public ---Functions ------------------------------------------------------------------------------------------------------//
//--------------------------------------------------------------------------------------------------------------------------------//
    
    /*! \fn setCache ($key, $value = null, $timeout = null)
     *  \brief Sets a key value pair for memcache
    */
    function setCache ($key, $value = null, $timeout = null) {
        if ($timeout == null || !is_numeric($timeout))
            $timeout = $this->defaultTimeout;
            
        return ($this->server->set(md5($key), $value, $timeout));
    }
    
    /*! \fn getCache ($key)
     *  \brief Gets a previously saved value from a key
    */
    function getCache ($key) {
        return ($this->server->get(md5($key)));
    }
    
}
?>